<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React | 炫</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="shortcut icon" href="/Notes/favicon.ico">
    <meta name="description" content="学习笔记">
    
    <link rel="preload" href="/Notes/assets/css/0.styles.a503b4b5.css" as="style"><link rel="preload" href="/Notes/assets/js/app.e773d1be.js" as="script"><link rel="preload" href="/Notes/assets/js/2.6c1319ac.js" as="script"><link rel="preload" href="/Notes/assets/js/1.5a5e16a8.js" as="script"><link rel="preload" href="/Notes/assets/js/17.8b0b4db8.js" as="script"><link rel="prefetch" href="/Notes/assets/js/10.1c9f2fcc.js"><link rel="prefetch" href="/Notes/assets/js/11.404b6dda.js"><link rel="prefetch" href="/Notes/assets/js/12.8da9548f.js"><link rel="prefetch" href="/Notes/assets/js/13.9be5c86a.js"><link rel="prefetch" href="/Notes/assets/js/14.53d3cf59.js"><link rel="prefetch" href="/Notes/assets/js/15.75d75712.js"><link rel="prefetch" href="/Notes/assets/js/16.bd61cf89.js"><link rel="prefetch" href="/Notes/assets/js/18.af740b3c.js"><link rel="prefetch" href="/Notes/assets/js/19.ff5e04bd.js"><link rel="prefetch" href="/Notes/assets/js/20.95338826.js"><link rel="prefetch" href="/Notes/assets/js/21.5f7e0bd2.js"><link rel="prefetch" href="/Notes/assets/js/22.e3996465.js"><link rel="prefetch" href="/Notes/assets/js/23.dd42961e.js"><link rel="prefetch" href="/Notes/assets/js/24.89e60f09.js"><link rel="prefetch" href="/Notes/assets/js/25.4a1ec1d8.js"><link rel="prefetch" href="/Notes/assets/js/26.045196da.js"><link rel="prefetch" href="/Notes/assets/js/27.1cf9d36e.js"><link rel="prefetch" href="/Notes/assets/js/28.5ddc9df5.js"><link rel="prefetch" href="/Notes/assets/js/29.51c5345f.js"><link rel="prefetch" href="/Notes/assets/js/3.28fa5fee.js"><link rel="prefetch" href="/Notes/assets/js/30.2c775243.js"><link rel="prefetch" href="/Notes/assets/js/31.fa601e01.js"><link rel="prefetch" href="/Notes/assets/js/32.8209b8f7.js"><link rel="prefetch" href="/Notes/assets/js/33.b7788b0b.js"><link rel="prefetch" href="/Notes/assets/js/34.ac12cb38.js"><link rel="prefetch" href="/Notes/assets/js/35.fa00fb0e.js"><link rel="prefetch" href="/Notes/assets/js/36.5a128296.js"><link rel="prefetch" href="/Notes/assets/js/37.ae8a1c66.js"><link rel="prefetch" href="/Notes/assets/js/38.01c876b6.js"><link rel="prefetch" href="/Notes/assets/js/39.a430279f.js"><link rel="prefetch" href="/Notes/assets/js/4.44e53d48.js"><link rel="prefetch" href="/Notes/assets/js/40.58245cee.js"><link rel="prefetch" href="/Notes/assets/js/41.6fa137a6.js"><link rel="prefetch" href="/Notes/assets/js/42.f5986218.js"><link rel="prefetch" href="/Notes/assets/js/43.908dc8b0.js"><link rel="prefetch" href="/Notes/assets/js/44.73cea0c2.js"><link rel="prefetch" href="/Notes/assets/js/45.875c8f46.js"><link rel="prefetch" href="/Notes/assets/js/46.ceb4dbec.js"><link rel="prefetch" href="/Notes/assets/js/47.dcb12197.js"><link rel="prefetch" href="/Notes/assets/js/48.ded3fb9e.js"><link rel="prefetch" href="/Notes/assets/js/49.54e94820.js"><link rel="prefetch" href="/Notes/assets/js/5.ebf595b6.js"><link rel="prefetch" href="/Notes/assets/js/50.63e48f48.js"><link rel="prefetch" href="/Notes/assets/js/51.7e4af462.js"><link rel="prefetch" href="/Notes/assets/js/52.d61ec835.js"><link rel="prefetch" href="/Notes/assets/js/53.836cb30f.js"><link rel="prefetch" href="/Notes/assets/js/54.77747ea5.js"><link rel="prefetch" href="/Notes/assets/js/55.a45498b2.js"><link rel="prefetch" href="/Notes/assets/js/56.31d8650e.js"><link rel="prefetch" href="/Notes/assets/js/57.d54105aa.js"><link rel="prefetch" href="/Notes/assets/js/58.b0780471.js"><link rel="prefetch" href="/Notes/assets/js/59.d38165d1.js"><link rel="prefetch" href="/Notes/assets/js/60.4ce717da.js"><link rel="prefetch" href="/Notes/assets/js/61.90977508.js"><link rel="prefetch" href="/Notes/assets/js/62.8b0b1429.js"><link rel="prefetch" href="/Notes/assets/js/63.6f6c7222.js"><link rel="prefetch" href="/Notes/assets/js/64.db097337.js"><link rel="prefetch" href="/Notes/assets/js/65.65641ee2.js"><link rel="prefetch" href="/Notes/assets/js/66.495b0673.js"><link rel="prefetch" href="/Notes/assets/js/67.897dec6e.js"><link rel="prefetch" href="/Notes/assets/js/68.a81e7e12.js"><link rel="prefetch" href="/Notes/assets/js/69.23e234f4.js"><link rel="prefetch" href="/Notes/assets/js/70.62cdfd23.js"><link rel="prefetch" href="/Notes/assets/js/71.e5d44f88.js"><link rel="prefetch" href="/Notes/assets/js/72.8d2fdbec.js"><link rel="prefetch" href="/Notes/assets/js/73.77e0a646.js"><link rel="prefetch" href="/Notes/assets/js/74.687023c7.js"><link rel="prefetch" href="/Notes/assets/js/75.6ed234fd.js"><link rel="prefetch" href="/Notes/assets/js/76.4f7e47ca.js"><link rel="prefetch" href="/Notes/assets/js/77.9ba5a8c9.js"><link rel="prefetch" href="/Notes/assets/js/78.020b2f81.js"><link rel="prefetch" href="/Notes/assets/js/79.8495e8f1.js"><link rel="prefetch" href="/Notes/assets/js/8.c2996aad.js"><link rel="prefetch" href="/Notes/assets/js/80.3f2bcc6a.js"><link rel="prefetch" href="/Notes/assets/js/81.c2d2ec54.js"><link rel="prefetch" href="/Notes/assets/js/82.2c144b55.js"><link rel="prefetch" href="/Notes/assets/js/83.29890e79.js"><link rel="prefetch" href="/Notes/assets/js/84.00371102.js"><link rel="prefetch" href="/Notes/assets/js/9.c7108ba4.js"><link rel="prefetch" href="/Notes/assets/js/vendors~docsearch.649f9bfd.js">
    <link rel="stylesheet" href="/Notes/assets/css/0.styles.a503b4b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Notes/" class="home-link router-link-active"><img src="/Notes/logo.png" alt="炫" class="logo"> <span class="site-name can-hide">炫</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Notes/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notes/HTML-CSS/HTML.html" class="nav-link">
  HTML CSS
</a></li><li class="dropdown-item"><!----> <a href="/Notes/JavaScript/API.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/Notes/TypeScript/index.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/Notes/Vue/index.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/Notes/React/index.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Notes/MiniProgram/index.html" class="nav-link">
  小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notes/Node/index.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/Notes/Deno/index.html" class="nav-link">
  Deno
</a></li><li class="dropdown-item"><!----> <a href="/Notes/Python/index.html" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notes/MySQL/index.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/Notes/MongoDB/index.html" class="nav-link">
  MongoDB
</a></li></ul></div></div><div class="nav-item"><a href="/Notes/other/index.html" class="nav-link">
  文档
</a></div> <a href="https://github.com/xuan-zhang/Notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Notes/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notes/HTML-CSS/HTML.html" class="nav-link">
  HTML CSS
</a></li><li class="dropdown-item"><!----> <a href="/Notes/JavaScript/API.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/Notes/TypeScript/index.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/Notes/Vue/index.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/Notes/React/index.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Notes/MiniProgram/index.html" class="nav-link">
  小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notes/Node/index.html" class="nav-link">
  Node
</a></li><li class="dropdown-item"><!----> <a href="/Notes/Deno/index.html" class="nav-link">
  Deno
</a></li><li class="dropdown-item"><!----> <a href="/Notes/Python/index.html" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Notes/MySQL/index.html" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/Notes/MongoDB/index.html" class="nav-link">
  MongoDB
</a></li></ul></div></div><div class="nav-item"><a href="/Notes/other/index.html" class="nav-link">
  文档
</a></div> <a href="https://github.com/xuan-zhang/Notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Notes/React/" aria-current="page" class="active sidebar-link">React</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Notes/React/#组件" class="sidebar-link">组件</a></li><li class="sidebar-sub-header"><a href="/Notes/React/#组件传参" class="sidebar-link">组件传参</a></li><li class="sidebar-sub-header"><a href="/Notes/React/#jsx" class="sidebar-link">JSX</a></li><li class="sidebar-sub-header"><a href="/Notes/React/#api" class="sidebar-link">API</a></li><li class="sidebar-sub-header"><a href="/Notes/React/#生命周期" class="sidebar-link">生命周期</a></li></ul></li><li><a href="/Notes/React/eslint.html" class="sidebar-link">配置 Eslint  Prettier</a></li><li><a href="/Notes/React/工具库.html" class="sidebar-link">React 中常用插件与包</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react"><a href="#react" class="header-anchor">#</a> React</h1> <blockquote><p><a href="https://www.html.cn/create-react-app/docs/getting-started/" target="_blank" rel="noopener noreferrer">create-react-app<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://zh-hans.reactjs.org/" target="_blank" rel="noopener noreferrer">react<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://redux.js.org/" target="_blank" rel="noopener noreferrer">redux<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://www.redux.org.cn/" target="_blank" rel="noopener noreferrer">redux中文文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://reactnative.dev/" target="_blank" rel="noopener noreferrer">reactnative<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="http://react-guide.github.io/react-router-cn/docs/Introduction.html" target="_blank" rel="noopener noreferrer">react-router<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="组件"><a href="#组件" class="header-anchor">#</a> 组件</h2> <ul><li>react 组件必须首字母大写
<ul><li>组件大小写是为了区别通过HTML标签定义的JSX，大写的组件在定义时，其type会是React.Component类型，若是将组件名写成了小写，则定义时会将其当作HTML标签定义进行</li></ul></li> <li>组件声明
<ul><li>函数式定义的无状态组件
<ul><li>一个函数式组件不能在另一个函数式组件内声明</li></ul></li> <li><s>es5原生方式React.createClass定义的组件</s></li> <li>es6形式的extends React.Component定义的组件</li></ul></li> <li>代码中使用 emoji： 用 span 标签，并设置 role='img' <code>aria-abel</code> 或 <code>aria-labelledby</code> <ul><li><code>&lt;span role=&quot;img&quot; aria-label=&quot;happy&quot;&gt;😁&lt;/span&gt;</code></li></ul></li></ul> <h2 id="组件传参"><a href="#组件传参" class="header-anchor">#</a> 组件传参</h2> <ul><li>props</li> <li>回调函数</li> <li>观察者模式</li> <li>context</li> <li>react-redux</li></ul> <h2 id="jsx"><a href="#jsx" class="header-anchor">#</a> JSX</h2> <ul><li>用户定义的组件必须以大写字母开头</li> <li><code>&lt;input type=&quot;text&quot; value=&quot;haha&quot;&gt;</code> 的 react 中 不能编辑 但在原生 html 中 可编辑， 如 <code>value={undefined}</code> 则可编辑</li> <li><code>class</code> 变成 <code>className</code></li> <li><code>for</code> 变成 <code>htmlFor</code></li> <li><code>tableindex</code> 变成 <code>tableIndex</code></li> <li><code>style</code> 必须是 <code>Object</code> 对象形式 <code>style={ {textAlign: 'left'} }</code></li> <li>可以在 <code>for if</code> 等语句中使用 <code>jsx</code>; 但不可以在 <code>jsx</code> 中使用 <code>for if</code>, 可以用 <code>?:</code> <code>&amp;&amp;</code></li></ul> <h2 id="api"><a href="#api" class="header-anchor">#</a> API</h2> <h3 id="props"><a href="#props" class="header-anchor">#</a> props</h3> <ul><li><code>static defaultProps</code>: 设置默认 <code>props</code> <ul><li>如同 vue 中的 props 里的 <code>default</code> 参数</li></ul></li> <li><code>props.children</code>: 组件的所有子节点
<ul><li>类似于 vue 中的 <code>default slot</code></li> <li>react 中没有 插槽概念，但 可以将任何东西作为 props 进行传递。</li> <li>当不插入内容或内容为换行符时，props.children为undefined</li> <li>当插入多个内容时，props.children为Array（多个文本视为一个内容）</li> <li>当插入一个内容时，props.children为插入值</li> <li>父组件的属性传给所有子组件就要用到 <code>React.Children</code></li></ul></li></ul> <h3 id="state"><a href="#state" class="header-anchor">#</a> state</h3> <ul><li><code>setState</code> <ul><li>调用此方法就会触发更新阶段钩子函数</li> <li>可以设置未在 <code>state</code> 中初始化的字段，添加新的字段</li> <li>在周期函数中的使用
<ul><li>在 <code>constructor</code>使用无效</li> <li>在 <code>static getDerivedStateFromProps</code> 不能调用</li> <li>在 <s><code>componentWillMount</code></s> 中使用有效，但不一定会引起组件重新渲染</li> <li>在 <s><code>componentWillReceiveProps</code></s> 中可以使用</li> <li>不能在 <code>shouldComponentUpdate</code> <s><code>componentWillUpdate</code></s> 中调用，会引起死循环</li> <li>在 <code>render</code> 中使用会陷入死循环</li> <li>在 <code>componentDidUpdate</code> 中使用要特别注意判断，否则会陷入死循环</li> <li>在 <code>componentDidMount</code> 中可以使用，用于接口数据获取</li></ul></li></ul></li></ul> <h3 id="react-fragment"><a href="#react-fragment" class="header-anchor">#</a> React.Fragment</h3> <ul><li><code>&lt;React.Fragment&gt;...&lt;/React.Fragment&gt;</code> <ul><li>不会渲染成标签</li> <li>可以有 key属性，也是目前唯一的属性</li></ul></li> <li>短语法： <code>&lt;&gt;...&lt;/&gt;</code> <ul><li>不支持 key 与其它属性</li></ul></li> <li>类似于 vue 中的 <code>template</code></li></ul> <h3 id="react-lazy"><a href="#react-lazy" class="header-anchor">#</a> React.lazy</h3> <blockquote><p><code>React.lazy</code> 和 <code>Suspense</code> 技术还不支持服务端渲染</p></blockquote> <ul><li><p>像渲染常规组件一样处理动态引入（的组件)</p></li> <li><p><code>const OtherComponent = React.lazy(() =&gt; import('./OtherComponent'));</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Suspense <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> OtherComponent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./OtherComponent'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> AnotherComponent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./AnotherComponent'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>section<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>OtherComponent <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>AnotherComponent <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li></ul> <h3 id="suspense"><a href="#suspense" class="header-anchor">#</a> Suspense</h3> <h3 id="context"><a href="#context" class="header-anchor">#</a> Context</h3> <ul><li><code>React.createContext(defaultValue)</code></li> <li><code>Context.Provider</code></li> <li><code>Class.contextType</code> <ul><li><code>static contextType = MyContext</code></li></ul></li> <li><code>Context.Consumer</code></li> <li><code>Context.displayName</code></li></ul> <blockquote><p><a href="https://segmentfault.com/a/1190000017483690" target="_blank" rel="noopener noreferrer">全面了解 React 新功能: Suspense 和 Hooks<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h3 id="static-getderivedstatefromerror"><a href="#static-getderivedstatefromerror" class="header-anchor">#</a> static getDerivedStateFromError()</h3> <h3 id="ref"><a href="#ref" class="header-anchor">#</a> Ref</h3> <ul><li>React.createRef
<ul><li>v16 版本之后新增，取值在 <code>this.textInput.current</code></li> <li>v16 版本之前，使用函数 <code>ref={ele =&gt; this.textInput = ele}</code></li> <li>不能在函数组件上使用 ref 属性，因为函数组件没有实例</li></ul></li> <li>React.useRef
<ul><li>仅限于在函数组件内使用</li> <li>useRef 返回的 ref 对象在组件的整个生命周期内保持不变</li></ul></li> <li>React.forwardRef
<ul><li>v16 新增，转发 ref</li></ul></li></ul> <h3 id="react-purecomponent"><a href="#react-purecomponent" class="header-anchor">#</a> React.PureComponent</h3> <ul><li><a href="https://zh-hans.reactjs.org/docs/react-api.html#reactpurecomponent" target="_blank" rel="noopener noreferrer">文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>React.PureComponent</code> 与 <code>React.Component</code> 很相似。两者的区别在于 <code>React.Component</code> 并未实现 <code>shouldComponentUpdate()</code>，而 <code>React.PureComponent</code> 中以浅层对比 <code>prop</code> 和 <code>state</code> 的方式来实现了该函数。</li></ul> <h3 id="reactdom-createportal"><a href="#reactdom-createportal" class="header-anchor">#</a> ReactDOM.createPortal</h3> <h3 id="react-profiler"><a href="#react-profiler" class="header-anchor">#</a> React.Profiler</h3> <h3 id="react-createelement"><a href="#react-createelement" class="header-anchor">#</a> React.createElement</h3> <h3 id="proptypes"><a href="#proptypes" class="header-anchor">#</a> PropTypes</h3> <ul><li><a href="https://zh-hans.reactjs.org/docs/typechecking-with-proptypes.html#gatsby-focus-wrapper" target="_blank" rel="noopener noreferrer">文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>类型检测，类似 vue 中 props 类型检查</li> <li>使用 <code>TS</code> 可以省略此步骤</li> <li>自 React v15.5 起，<code>React.PropTypes</code> 已移入另一个包中。请使用 <code>prop-types</code> 库代替</li></ul> <h2 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h2> <blockquote><p><code>componentWillMount</code> <code>componentWillReceiveProps</code> <code>componentWillUpdate</code>周期会在 v17 版本之后保留删除，<code>UNSAFE_*</code> 函数会保留<br>
因 <code>React Fiber</code>, 周期改变</p></blockquote> <ul><li><a href="https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/" target="_blank" rel="noopener noreferrer">生命周期图谱<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>旧版生命周期(v16.0前)
<ul><li><img src="/Notes/assets/img/reactLifecycleOld.7e04781c.jpg" alt="react生命周期旧"></li> <li><img src="/Notes/assets/img/reactLifecycleRunOld.d90843bb.png" alt="react生命周期旧"></li></ul></li> <li>新版生命周期(v16.3后)
<ul><li><img src="/Notes/assets/img/reactLifecycleNew.b8fb4ab5.jpg" alt="生命周期"></li> <li><img src="/Notes/assets/img/reactLifecycleType.fa513f62.png" alt="生命周期"></li></ul></li></ul> <h3 id="初始化阶段"><a href="#初始化阶段" class="header-anchor">#</a> 初始化阶段</h3> <ul><li><code>constructor(props: Readonly&lt;P&gt;, context?: any)</code> <ul><li>只调用一次 <code>super</code> 必须在使用 <code>this</code> 语句之前调用</li> <li>参数: <code>props</code></li> <li>作用
<ul><li>初始化 <code>state</code></li> <li>...</li></ul></li></ul></li></ul> <h3 id="挂载阶段"><a href="#挂载阶段" class="header-anchor">#</a> 挂载阶段</h3> <ul><li><s><code>componentWillMount()/UNSAFE_componentWillMount()?:void</code></s> <ul><li>组件挂载之前调用，只调用一次 使用 <code>contructor</code> 代替</li> <li>此时调用 <code>this.setState</code> 不一定会引起组件重新渲染</li> <li>在Fiber之后， 由于任务可中断，willMount可能会被执行多次</li></ul></li> <li><code>static getDerivedStateFromProps(nextProps, prevState):Partial&lt;prevState&gt; | null</code></li> <li><code>render(): ReactNode</code> <ul><li>用来渲染DOM</li> <li>必须是纯函数</li> <li>返回 <code>JSX.Element</code></li> <li>不要在 <code>render</code> 里面修改 <code>state</code>，会触发死循环导致栈溢出</li></ul></li> <li><code>componentDidMount?(): void</code> <ul><li>组件挂载后调用， 只调用一次</li> <li>可以在这里使用 refs 获取真实 DOM</li> <li>可在此处发起 异步请求 并进行 <code>setSate</code></li> <li>依赖 DOM 初始化 添加事件监听</li></ul></li></ul> <h3 id="更新阶段"><a href="#更新阶段" class="header-anchor">#</a> 更新阶段</h3> <blockquote><p><code>setState</code> 引起的 <code>state</code> 更新<br>
父组件能过 <code>setState</code> 引起的 <code>props</code> 变化时，触发更新阶段<br>
父组件 <code>render</code> 触发时， 触发更新子组件更新阶段
更新后的 state 和 props 相对之前的无论是否变化，都会引起组件重新 render</p></blockquote> <ul><li><s><code>componentWillReceiveProps()/UNSAFE_componentWillReceiveProps(nextProps, nextContext)</code></s> <ul><li><code>props</code> 变化与 父组件重新渲染时，都会触发</li> <li><code>nextProps</code> 变化之后的 <code>props</code> 参数
<ul><li>在该函数内使用 <code>this.props</code> 返回的是未更新前的 <code>props</code></li> <li>可以在此函数内使用 <code>setState</code></li></ul></li></ul></li> <li><code>static getDerivedStateFromProps(nextProps, prevState):Partial&lt;prevState&gt; | null</code> <ul><li>每次渲染之前都会调用, 不管造成重新渲染的原因是什么，不管初始挂载还是后面的更新都会调用</li> <li>需要在该方法中返回一个对象或null
<ul><li>如果返回的是对象，则会更新 state，返回结果会被送给setState</li> <li>如果返回的是null，则表示不更新。</li></ul></li> <li>使用该方法的时候需要初始化 <code>state</code> ，否则在控制台中会出现警告信息，不能在该方法内部，调用 <code>this.state</code></li> <li>无法在此函数内使用 <code>this</code>, 这里的 <code>this</code> 指向 <code>undefined</code></li> <li>将父组件传递过来的 props 映射 到子组件的 state 上面，这样组件内部就不用再通过 this.props.xxx 获取属性值了，统一通过 this.state.xxx 获取. 映射就相当于拷贝了一份父组件传过来的 props ，作为子组件自己的状态。注意：子组件通过 setState 更新自身状态时，不会改变父组件的 props</li> <li>配合 componentDidUpdate，可以覆盖 componentWillReceiveProps 的所有用法</li></ul></li> <li><code>shouldComponentUpdate(nextProps, nextState, nextConext):boolean</code> <ul><li>在首次渲染时或者 <code>forceUpdate()</code> 时不会触发</li> <li>每次调用 <code>setState</code> 都会触发，用于判断是否要重新渲染组件</li> <li>能过比较 <code>nextProps</code> <code>nextState</code> 及当前组件的 <code>this.props</code> <code>this.state</code> 的状态来判断是否重新渲染</li> <li>如果返回 <code>false</code> 后续周期函数不再触发
<ul><li>React 可能将shouldComponentUpdate视做提示而不是严格的根据它的返回结果决定是否执行，也就是说可能出现shouldComponentUpdate返回false，但是还是发生重新渲染</li></ul></li> <li>不能使用 <code>setState</code>, 会死循环</li> <li>一般能过此函数进行性能优化
<ul><li>父组件 <code>render</code> 会触发 子级组件 更新阶段</li> <li>可在些函数中中止不必要的更新，后台的 虚拟 DOM diff ...</li></ul></li></ul></li> <li><s><code>componentWillUpdate()/UNSAFE_componentWillUpdate(nextProps, nextState, nextContext)</code></s> <ul><li>组件即将被更新时触发</li> <li><code>shouldComponentUpdate</code> 返回 <code>true</code> 或 调用 <code>forceUpdate</code> 之后调用</li> <li>不能在该钩子中使用 <code>setState</code></li></ul></li> <li><code>render()</code></li> <li><code>getSnapshotBeforeUpdate(prevProps, prevState): any | null</code> <ul><li>被调用于 render 之后、更新 DOM 和 refs 之前</li> <li>返回值称为一个快照（snapshot），如果不需要 snapshot，则必须显示的返回 <code>null</code></li> <li>返回值将作为 <code>componentDidUpdate()</code> 的第三个参数使用。所以这个函数必须要配合 <code>componentDidUpdate</code>() 一起使用, 可以覆盖 <code>componentWillUpdate</code> 的所有用法
<ul><li>在 <code>getSnapShotBeforeUpdate</code> 中获取滚动位置，然后作为参数传给 <code>componentDidUpdate</code>，就可以直接在渲染真实的 DOM 时就滚动到需要的位置。</li></ul></li></ul></li> <li><code>componentDidUpdate(prevProps, prevState, snapShot)</code> <ul><li>该方法不会再组件初始化时触发</li> <li>组件更新之后调用</li> <li><code>props</code> <code>state</code> 中此钩子函数内已更改成最新, <code>this.props</code> 访问到的是新的 <code>props</code></li> <li>钩子内 <code>setState</code> 有可能会触发重复渲染，需要自行判断，否则会进入死循环</li></ul></li></ul> <h3 id="卸载阶段"><a href="#卸载阶段" class="header-anchor">#</a> 卸载阶段</h3> <ul><li><code>componentWillUnmount()</code> <ul><li>组件卸载前调用</li> <li>进行一些清理工作
<ul><li>去除定时器</li> <li>取消 Redux 订阅事件</li> <li>清除 componentDidMount 中手动创建的 DOM 元素</li> <li>去除可能的内存泄露</li> <li>...</li></ul></li></ul></li></ul> <h3 id="错误捕获"><a href="#错误捕获" class="header-anchor">#</a> 错误捕获</h3> <ul><li><code>componentDidCatch(error: Error, errorInfo: React.ErrorInfo)</code> <ul><li>任何子组件在渲染期间，生命周期方法中或者构造函数 <code>constructor</code> 发生错误时调用</li> <li>错误边界不会捕获下面的错误
<ul><li>事件处理 (Event handlers) （因为事件处理不发生在 React 渲染时，报错不影响渲染)</li> <li>异步代码 (Asynchronous code) (例如：setTimeout or requestAnimationFrame callbacks)</li> <li>服务端渲染 (Server side rendering)</li> <li>错误边界本身(而不是子组件)抛出的错误</li></ul></li></ul></li></ul> <h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <blockquote><p><a href="https://juejin.im/post/5df648836fb9a016526eba01" target="_blank" rel="noopener noreferrer">你真的了解 React 生命周期吗<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br> <a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#preferred-solutions" target="_blank" rel="noopener noreferrer">你可能不需要使用派生 state<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <ul><li>发起 ajax 请求，获取数据 <code>componentDidMount</code></li> <li>使用 refs 获取真实 DOM <code>componentDidMount</code></li> <li>将 <code>props</code> 变成 内部 <code>state</code>: <code>static getDerivedStateFromProps</code></li> <li>控制组件是否更新 <code>shouldComponentUpdate</code> <code>return true | false</code></li> <li>当外部的 props 改变时，如何再次执行请求数据、更改状态等操作
<ul><li><p>使用 <s><code>componentWillReceiveProps</code></s></p></li> <li><p>使用 <code>static getDerivedStateFromProps</code> + <code>componentDidUpdate</code> 加载数据</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">externalData</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>id <span class="token operator">!==</span> prevState<span class="token punctuation">.</span>prevId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">externalData</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
          <span class="token literal-property property">prevId</span><span class="token operator">:</span> nextProps<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_loadAsyncData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 借助 componentDidUpdate</span>
    <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>externalData <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_loadAsyncData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>externalData <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Render loading state ...</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// Render real UI ...</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token function">_loadAsyncData</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token function">asyncLoadData</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
        <span class="token parameter">externalData</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>_asyncRequest <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>externalData<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div></li> <li><p>使用 <code>static getDerivedStateFromProps</code> 更改状态</p></li> <li><p>只用 <code>componentDidUpdate</code> 的写法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>age <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;componentDidUpdate&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>age <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li></ul></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/xuan-zhang/Notes/edit/master/docs/React/index.md" target="_blank" rel="noopener noreferrer">在GitHub中编辑此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">2020/6/28 09:58:14</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/Notes/React/eslint.html">
        配置 Eslint  Prettier
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/Notes/assets/js/app.e773d1be.js" defer></script><script src="/Notes/assets/js/2.6c1319ac.js" defer></script><script src="/Notes/assets/js/1.5a5e16a8.js" defer></script><script src="/Notes/assets/js/17.8b0b4db8.js" defer></script>
  </body>
</html>
