(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{307:function(t,s,a){t.exports=a.p+"assets/img/reactLifecycleOld.7e04781c.jpg"},308:function(t,s,a){t.exports=a.p+"assets/img/reactLifecycleRunOld.d90843bb.png"},309:function(t,s,a){t.exports=a.p+"assets/img/reactLifecycleNew.b8fb4ab5.jpg"},310:function(t,s,a){t.exports=a.p+"assets/img/reactLifecycleType.fa513f62.png"},368:function(t,s,a){"use strict";a.r(s);var e=a(10),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"react"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react"}},[t._v("#")]),t._v(" React")]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://www.html.cn/create-react-app/docs/getting-started/",target:"_blank",rel:"noopener noreferrer"}},[t._v("create-react-app"),s("OutboundLink")],1),s("br"),t._v(" "),s("a",{attrs:{href:"https://zh-hans.reactjs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("react"),s("OutboundLink")],1),s("br"),t._v(" "),s("a",{attrs:{href:"https://redux.js.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("redux"),s("OutboundLink")],1),t._v(" "),s("a",{attrs:{href:"https://www.redux.org.cn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("redux中文文档"),s("OutboundLink")],1),s("br"),t._v(" "),s("a",{attrs:{href:"https://reactnative.dev/",target:"_blank",rel:"noopener noreferrer"}},[t._v("reactnative"),s("OutboundLink")],1),s("br"),t._v(" "),s("a",{attrs:{href:"http://react-guide.github.io/react-router-cn/docs/Introduction.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-router"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"组件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组件"}},[t._v("#")]),t._v(" 组件")]),t._v(" "),s("ul",[s("li",[t._v("react 组件必须首字母大写\n"),s("ul",[s("li",[t._v("组件大小写是为了区别通过HTML标签定义的JSX，大写的组件在定义时，其type会是React.Component类型，若是将组件名写成了小写，则定义时会将其当作HTML标签定义进行")])])]),t._v(" "),s("li",[t._v("组件声明\n"),s("ul",[s("li",[t._v("函数式定义的无状态组件\n"),s("ul",[s("li",[t._v("一个函数式组件不能在另一个函数式组件内声明")])])]),t._v(" "),s("li",[s("s",[t._v("es5原生方式React.createClass定义的组件")])]),t._v(" "),s("li",[t._v("es6形式的extends React.Component定义的组件")])])]),t._v(" "),s("li",[t._v("代码中使用 emoji： 用 span 标签，并设置 role='img' "),s("code",[t._v("aria-abel")]),t._v(" 或 "),s("code",[t._v("aria-labelledby")]),t._v(" "),s("ul",[s("li",[s("code",[t._v('<span role="img" aria-label="happy">😁</span>')])])])])]),t._v(" "),s("h2",{attrs:{id:"组件传参"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组件传参"}},[t._v("#")]),t._v(" 组件传参")]),t._v(" "),s("ul",[s("li",[t._v("props")]),t._v(" "),s("li",[t._v("回调函数")]),t._v(" "),s("li",[t._v("观察者模式")]),t._v(" "),s("li",[t._v("context")]),t._v(" "),s("li",[t._v("react-redux")])]),t._v(" "),s("h2",{attrs:{id:"jsx"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jsx"}},[t._v("#")]),t._v(" JSX")]),t._v(" "),s("ul",[s("li",[t._v("用户定义的组件必须以大写字母开头")]),t._v(" "),s("li",[s("code",[t._v('<input type="text" value="haha">')]),t._v(" 的 react 中 不能编辑 但在原生 html 中 可编辑， 如 "),s("code",[t._v("value={undefined}")]),t._v(" 则可编辑")]),t._v(" "),s("li",[s("code",[t._v("class")]),t._v(" 变成 "),s("code",[t._v("className")])]),t._v(" "),s("li",[s("code",[t._v("for")]),t._v(" 变成 "),s("code",[t._v("htmlFor")])]),t._v(" "),s("li",[s("code",[t._v("tableindex")]),t._v(" 变成 "),s("code",[t._v("tableIndex")])]),t._v(" "),s("li",[s("code",[t._v("style")]),t._v(" 必须是 "),s("code",[t._v("Object")]),t._v(" 对象形式 "),s("code",[t._v("style={ {textAlign: 'left'} }")])]),t._v(" "),s("li",[t._v("可以在 "),s("code",[t._v("for if")]),t._v(" 等语句中使用 "),s("code",[t._v("jsx")]),t._v("; 但不可以在 "),s("code",[t._v("jsx")]),t._v(" 中使用 "),s("code",[t._v("for if")]),t._v(", 可以用 "),s("code",[t._v("?:")]),t._v(" "),s("code",[t._v("&&")])])]),t._v(" "),s("h2",{attrs:{id:"api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),s("h3",{attrs:{id:"props"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#props"}},[t._v("#")]),t._v(" props")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("static defaultProps")]),t._v(": 设置默认 "),s("code",[t._v("props")]),t._v(" "),s("ul",[s("li",[t._v("如同 vue 中的 props 里的 "),s("code",[t._v("default")]),t._v(" 参数")])])]),t._v(" "),s("li",[s("code",[t._v("props.children")]),t._v(": 组件的所有子节点\n"),s("ul",[s("li",[t._v("类似于 vue 中的 "),s("code",[t._v("default slot")])]),t._v(" "),s("li",[t._v("react 中没有 插槽概念，但 可以将任何东西作为 props 进行传递。")]),t._v(" "),s("li",[t._v("当不插入内容或内容为换行符时，props.children为undefined")]),t._v(" "),s("li",[t._v("当插入多个内容时，props.children为Array（多个文本视为一个内容）")]),t._v(" "),s("li",[t._v("当插入一个内容时，props.children为插入值")]),t._v(" "),s("li",[t._v("父组件的属性传给所有子组件就要用到 "),s("code",[t._v("React.Children")])])])])]),t._v(" "),s("h3",{attrs:{id:"state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#state"}},[t._v("#")]),t._v(" state")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("setState")]),t._v(" "),s("ul",[s("li",[t._v("调用此方法就会触发更新阶段钩子函数")]),t._v(" "),s("li",[t._v("可以设置未在 "),s("code",[t._v("state")]),t._v(" 中初始化的字段，添加新的字段")]),t._v(" "),s("li",[t._v("在周期函数中的使用\n"),s("ul",[s("li",[t._v("在 "),s("code",[t._v("constructor")]),t._v("使用无效")]),t._v(" "),s("li",[t._v("在 "),s("code",[t._v("static getDerivedStateFromProps")]),t._v(" 不能调用")]),t._v(" "),s("li",[t._v("在 "),s("s",[s("code",[t._v("componentWillMount")])]),t._v(" 中使用有效，但不一定会引起组件重新渲染")]),t._v(" "),s("li",[t._v("在 "),s("s",[s("code",[t._v("componentWillReceiveProps")])]),t._v(" 中可以使用")]),t._v(" "),s("li",[t._v("不能在 "),s("code",[t._v("shouldComponentUpdate")]),t._v(" "),s("s",[s("code",[t._v("componentWillUpdate")])]),t._v(" 中调用，会引起死循环")]),t._v(" "),s("li",[t._v("在 "),s("code",[t._v("render")]),t._v(" 中使用会陷入死循环")]),t._v(" "),s("li",[t._v("在 "),s("code",[t._v("componentDidUpdate")]),t._v(" 中使用要特别注意判断，否则会陷入死循环")]),t._v(" "),s("li",[t._v("在 "),s("code",[t._v("componentDidMount")]),t._v(" 中可以使用，用于接口数据获取")])])])])])]),t._v(" "),s("h3",{attrs:{id:"react-fragment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-fragment"}},[t._v("#")]),t._v(" React.Fragment")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("<React.Fragment>...</React.Fragment>")]),t._v(" "),s("ul",[s("li",[t._v("不会渲染成标签")]),t._v(" "),s("li",[t._v("可以有 key属性，也是目前唯一的属性")])])]),t._v(" "),s("li",[t._v("短语法： "),s("code",[t._v("<>...</>")]),t._v(" "),s("ul",[s("li",[t._v("不支持 key 与其它属性")])])]),t._v(" "),s("li",[t._v("类似于 vue 中的 "),s("code",[t._v("template")])])]),t._v(" "),s("h3",{attrs:{id:"react-lazy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-lazy"}},[t._v("#")]),t._v(" React.lazy")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("React.lazy")]),t._v(" 和 "),s("code",[t._v("Suspense")]),t._v(" 技术还不支持服务端渲染")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("像渲染常规组件一样处理动态引入（的组件)")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("const OtherComponent = React.lazy(() => import('./OtherComponent'));")])]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" React"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Suspense "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'react'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" OtherComponent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" React"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lazy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./OtherComponent'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" AnotherComponent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" React"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("lazy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./AnotherComponent'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("MyComponent")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Suspense fallback"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("Loading"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("section"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("OtherComponent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("AnotherComponent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("section"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("Suspense"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("div"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])])])]),t._v(" "),s("h3",{attrs:{id:"suspense"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#suspense"}},[t._v("#")]),t._v(" Suspense")]),t._v(" "),s("h3",{attrs:{id:"context"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#context"}},[t._v("#")]),t._v(" Context")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("React.createContext(defaultValue)")])]),t._v(" "),s("li",[s("code",[t._v("Context.Provider")])]),t._v(" "),s("li",[s("code",[t._v("Class.contextType")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("static contextType = MyContext")])])])]),t._v(" "),s("li",[s("code",[t._v("Context.Consumer")])]),t._v(" "),s("li",[s("code",[t._v("Context.displayName")])])]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://segmentfault.com/a/1190000017483690",target:"_blank",rel:"noopener noreferrer"}},[t._v("全面了解 React 新功能: Suspense 和 Hooks"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"static-getderivedstatefromerror"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#static-getderivedstatefromerror"}},[t._v("#")]),t._v(" static getDerivedStateFromError()")]),t._v(" "),s("h3",{attrs:{id:"ref"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ref"}},[t._v("#")]),t._v(" Ref")]),t._v(" "),s("ul",[s("li",[t._v("React.createRef\n"),s("ul",[s("li",[t._v("v16 版本之后新增，取值在 "),s("code",[t._v("this.textInput.current")])]),t._v(" "),s("li",[t._v("v16 版本之前，使用函数 "),s("code",[t._v("ref={ele => this.textInput = ele}")])]),t._v(" "),s("li",[t._v("不能在函数组件上使用 ref 属性，因为函数组件没有实例")])])]),t._v(" "),s("li",[t._v("React.useRef\n"),s("ul",[s("li",[t._v("仅限于在函数组件内使用")]),t._v(" "),s("li",[t._v("useRef 返回的 ref 对象在组件的整个生命周期内保持不变")])])]),t._v(" "),s("li",[t._v("React.forwardRef\n"),s("ul",[s("li",[t._v("v16 新增，转发 ref")])])])]),t._v(" "),s("h3",{attrs:{id:"react-purecomponent"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-purecomponent"}},[t._v("#")]),t._v(" React.PureComponent")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/react-api.html#reactpurecomponent",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("code",[t._v("React.PureComponent")]),t._v(" 与 "),s("code",[t._v("React.Component")]),t._v(" 很相似。两者的区别在于 "),s("code",[t._v("React.Component")]),t._v(" 并未实现 "),s("code",[t._v("shouldComponentUpdate()")]),t._v("，而 "),s("code",[t._v("React.PureComponent")]),t._v(" 中以浅层对比 "),s("code",[t._v("prop")]),t._v(" 和 "),s("code",[t._v("state")]),t._v(" 的方式来实现了该函数。")])]),t._v(" "),s("h3",{attrs:{id:"reactdom-createportal"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reactdom-createportal"}},[t._v("#")]),t._v(" ReactDOM.createPortal")]),t._v(" "),s("h3",{attrs:{id:"react-profiler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-profiler"}},[t._v("#")]),t._v(" React.Profiler")]),t._v(" "),s("h3",{attrs:{id:"react-createelement"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-createelement"}},[t._v("#")]),t._v(" React.createElement")]),t._v(" "),s("h3",{attrs:{id:"proptypes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proptypes"}},[t._v("#")]),t._v(" PropTypes")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/typechecking-with-proptypes.html#gatsby-focus-wrapper",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("类型检测，类似 vue 中 props 类型检查")]),t._v(" "),s("li",[t._v("使用 "),s("code",[t._v("TS")]),t._v(" 可以省略此步骤")]),t._v(" "),s("li",[t._v("自 React v15.5 起，"),s("code",[t._v("React.PropTypes")]),t._v(" 已移入另一个包中。请使用 "),s("code",[t._v("prop-types")]),t._v(" 库代替")])]),t._v(" "),s("h2",{attrs:{id:"生命周期"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生命周期"}},[t._v("#")]),t._v(" 生命周期")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("componentWillMount")]),t._v(" "),s("code",[t._v("componentWillReceiveProps")]),t._v(" "),s("code",[t._v("componentWillUpdate")]),t._v("周期会在 v17 版本之后保留删除，"),s("code",[t._v("UNSAFE_*")]),t._v(" 函数会保留"),s("br"),t._v("\n因 "),s("code",[t._v("React Fiber")]),t._v(", 周期改变")])]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/",target:"_blank",rel:"noopener noreferrer"}},[t._v("生命周期图谱"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("旧版生命周期(v16.0前)\n"),s("ul",[s("li",[s("img",{attrs:{src:a(307),alt:"react生命周期旧"}})]),t._v(" "),s("li",[s("img",{attrs:{src:a(308),alt:"react生命周期旧"}})])])]),t._v(" "),s("li",[t._v("新版生命周期(v16.3后)\n"),s("ul",[s("li",[s("img",{attrs:{src:a(309),alt:"生命周期"}})]),t._v(" "),s("li",[s("img",{attrs:{src:a(310),alt:"生命周期"}})])])])]),t._v(" "),s("h3",{attrs:{id:"初始化阶段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#初始化阶段"}},[t._v("#")]),t._v(" 初始化阶段")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("constructor(props: Readonly<P>, context?: any)")]),t._v(" "),s("ul",[s("li",[t._v("只调用一次 "),s("code",[t._v("super")]),t._v(" 必须在使用 "),s("code",[t._v("this")]),t._v(" 语句之前调用")]),t._v(" "),s("li",[t._v("参数: "),s("code",[t._v("props")])]),t._v(" "),s("li",[t._v("作用\n"),s("ul",[s("li",[t._v("初始化 "),s("code",[t._v("state")])]),t._v(" "),s("li",[t._v("...")])])])])])]),t._v(" "),s("h3",{attrs:{id:"挂载阶段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#挂载阶段"}},[t._v("#")]),t._v(" 挂载阶段")]),t._v(" "),s("ul",[s("li",[s("s",[s("code",[t._v("componentWillMount()/UNSAFE_componentWillMount()?:void")])]),t._v(" "),s("ul",[s("li",[t._v("组件挂载之前调用，只调用一次 使用 "),s("code",[t._v("contructor")]),t._v(" 代替")]),t._v(" "),s("li",[t._v("此时调用 "),s("code",[t._v("this.setState")]),t._v(" 不一定会引起组件重新渲染")]),t._v(" "),s("li",[t._v("在Fiber之后， 由于任务可中断，willMount可能会被执行多次")])])]),t._v(" "),s("li",[s("code",[t._v("static getDerivedStateFromProps(nextProps, prevState):Partial<prevState> | null")])]),t._v(" "),s("li",[s("code",[t._v("render(): ReactNode")]),t._v(" "),s("ul",[s("li",[t._v("用来渲染DOM")]),t._v(" "),s("li",[t._v("必须是纯函数")]),t._v(" "),s("li",[t._v("返回 "),s("code",[t._v("JSX.Element")])]),t._v(" "),s("li",[t._v("不要在 "),s("code",[t._v("render")]),t._v(" 里面修改 "),s("code",[t._v("state")]),t._v("，会触发死循环导致栈溢出")])])]),t._v(" "),s("li",[s("code",[t._v("componentDidMount?(): void")]),t._v(" "),s("ul",[s("li",[t._v("组件挂载后调用， 只调用一次")]),t._v(" "),s("li",[t._v("可以在这里使用 refs 获取真实 DOM")]),t._v(" "),s("li",[t._v("可在此处发起 异步请求 并进行 "),s("code",[t._v("setSate")])]),t._v(" "),s("li",[t._v("依赖 DOM 初始化 添加事件监听")])])])]),t._v(" "),s("h3",{attrs:{id:"更新阶段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新阶段"}},[t._v("#")]),t._v(" 更新阶段")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("setState")]),t._v(" 引起的 "),s("code",[t._v("state")]),t._v(" 更新"),s("br"),t._v("\n父组件能过 "),s("code",[t._v("setState")]),t._v(" 引起的 "),s("code",[t._v("props")]),t._v(" 变化时，触发更新阶段"),s("br"),t._v("\n父组件 "),s("code",[t._v("render")]),t._v(" 触发时， 触发更新子组件更新阶段\n更新后的 state 和 props 相对之前的无论是否变化，都会引起组件重新 render")])]),t._v(" "),s("ul",[s("li",[s("s",[s("code",[t._v("componentWillReceiveProps()/UNSAFE_componentWillReceiveProps(nextProps, nextContext)")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("props")]),t._v(" 变化与 父组件重新渲染时，都会触发")]),t._v(" "),s("li",[s("code",[t._v("nextProps")]),t._v(" 变化之后的 "),s("code",[t._v("props")]),t._v(" 参数\n"),s("ul",[s("li",[t._v("在该函数内使用 "),s("code",[t._v("this.props")]),t._v(" 返回的是未更新前的 "),s("code",[t._v("props")])]),t._v(" "),s("li",[t._v("可以在此函数内使用 "),s("code",[t._v("setState")])])])])])]),t._v(" "),s("li",[s("code",[t._v("static getDerivedStateFromProps(nextProps, prevState):Partial<prevState> | null")]),t._v(" "),s("ul",[s("li",[t._v("每次渲染之前都会调用, 不管造成重新渲染的原因是什么，不管初始挂载还是后面的更新都会调用")]),t._v(" "),s("li",[t._v("需要在该方法中返回一个对象或null\n"),s("ul",[s("li",[t._v("如果返回的是对象，则会更新 state，返回结果会被送给setState")]),t._v(" "),s("li",[t._v("如果返回的是null，则表示不更新。")])])]),t._v(" "),s("li",[t._v("使用该方法的时候需要初始化 "),s("code",[t._v("state")]),t._v(" ，否则在控制台中会出现警告信息，不能在该方法内部，调用 "),s("code",[t._v("this.state")])]),t._v(" "),s("li",[t._v("无法在此函数内使用 "),s("code",[t._v("this")]),t._v(", 这里的 "),s("code",[t._v("this")]),t._v(" 指向 "),s("code",[t._v("undefined")])]),t._v(" "),s("li",[t._v("将父组件传递过来的 props 映射 到子组件的 state 上面，这样组件内部就不用再通过 this.props.xxx 获取属性值了，统一通过 this.state.xxx 获取. 映射就相当于拷贝了一份父组件传过来的 props ，作为子组件自己的状态。注意：子组件通过 setState 更新自身状态时，不会改变父组件的 props")]),t._v(" "),s("li",[t._v("配合 componentDidUpdate，可以覆盖 componentWillReceiveProps 的所有用法")])])]),t._v(" "),s("li",[s("code",[t._v("shouldComponentUpdate(nextProps, nextState, nextConext):boolean")]),t._v(" "),s("ul",[s("li",[t._v("在首次渲染时或者 "),s("code",[t._v("forceUpdate()")]),t._v(" 时不会触发")]),t._v(" "),s("li",[t._v("每次调用 "),s("code",[t._v("setState")]),t._v(" 都会触发，用于判断是否要重新渲染组件")]),t._v(" "),s("li",[t._v("能过比较 "),s("code",[t._v("nextProps")]),t._v(" "),s("code",[t._v("nextState")]),t._v(" 及当前组件的 "),s("code",[t._v("this.props")]),t._v(" "),s("code",[t._v("this.state")]),t._v(" 的状态来判断是否重新渲染")]),t._v(" "),s("li",[t._v("如果返回 "),s("code",[t._v("false")]),t._v(" 后续周期函数不再触发\n"),s("ul",[s("li",[t._v("React 可能将shouldComponentUpdate视做提示而不是严格的根据它的返回结果决定是否执行，也就是说可能出现shouldComponentUpdate返回false，但是还是发生重新渲染")])])]),t._v(" "),s("li",[t._v("不能使用 "),s("code",[t._v("setState")]),t._v(", 会死循环")]),t._v(" "),s("li",[t._v("一般能过此函数进行性能优化\n"),s("ul",[s("li",[t._v("父组件 "),s("code",[t._v("render")]),t._v(" 会触发 子级组件 更新阶段")]),t._v(" "),s("li",[t._v("可在些函数中中止不必要的更新，后台的 虚拟 DOM diff ...")])])])])]),t._v(" "),s("li",[s("s",[s("code",[t._v("componentWillUpdate()/UNSAFE_componentWillUpdate(nextProps, nextState, nextContext)")])]),t._v(" "),s("ul",[s("li",[t._v("组件即将被更新时触发")]),t._v(" "),s("li",[s("code",[t._v("shouldComponentUpdate")]),t._v(" 返回 "),s("code",[t._v("true")]),t._v(" 或 调用 "),s("code",[t._v("forceUpdate")]),t._v(" 之后调用")]),t._v(" "),s("li",[t._v("不能在该钩子中使用 "),s("code",[t._v("setState")])])])]),t._v(" "),s("li",[s("code",[t._v("render()")])]),t._v(" "),s("li",[s("code",[t._v("getSnapshotBeforeUpdate(prevProps, prevState): any | null")]),t._v(" "),s("ul",[s("li",[t._v("被调用于 render 之后、更新 DOM 和 refs 之前")]),t._v(" "),s("li",[t._v("返回值称为一个快照（snapshot），如果不需要 snapshot，则必须显示的返回 "),s("code",[t._v("null")])]),t._v(" "),s("li",[t._v("返回值将作为 "),s("code",[t._v("componentDidUpdate()")]),t._v(" 的第三个参数使用。所以这个函数必须要配合 "),s("code",[t._v("componentDidUpdate")]),t._v("() 一起使用, 可以覆盖 "),s("code",[t._v("componentWillUpdate")]),t._v(" 的所有用法\n"),s("ul",[s("li",[t._v("在 "),s("code",[t._v("getSnapShotBeforeUpdate")]),t._v(" 中获取滚动位置，然后作为参数传给 "),s("code",[t._v("componentDidUpdate")]),t._v("，就可以直接在渲染真实的 DOM 时就滚动到需要的位置。")])])])])]),t._v(" "),s("li",[s("code",[t._v("componentDidUpdate(prevProps, prevState, snapShot)")]),t._v(" "),s("ul",[s("li",[t._v("该方法不会再组件初始化时触发")]),t._v(" "),s("li",[t._v("组件更新之后调用")]),t._v(" "),s("li",[s("code",[t._v("props")]),t._v(" "),s("code",[t._v("state")]),t._v(" 中此钩子函数内已更改成最新, "),s("code",[t._v("this.props")]),t._v(" 访问到的是新的 "),s("code",[t._v("props")])]),t._v(" "),s("li",[t._v("钩子内 "),s("code",[t._v("setState")]),t._v(" 有可能会触发重复渲染，需要自行判断，否则会进入死循环")])])])]),t._v(" "),s("h3",{attrs:{id:"卸载阶段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#卸载阶段"}},[t._v("#")]),t._v(" 卸载阶段")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("componentWillUnmount()")]),t._v(" "),s("ul",[s("li",[t._v("组件卸载前调用")]),t._v(" "),s("li",[t._v("进行一些清理工作\n"),s("ul",[s("li",[t._v("去除定时器")]),t._v(" "),s("li",[t._v("取消 Redux 订阅事件")]),t._v(" "),s("li",[t._v("清除 componentDidMount 中手动创建的 DOM 元素")]),t._v(" "),s("li",[t._v("去除可能的内存泄露")]),t._v(" "),s("li",[t._v("...")])])])])])]),t._v(" "),s("h3",{attrs:{id:"错误捕获"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#错误捕获"}},[t._v("#")]),t._v(" 错误捕获")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("componentDidCatch(error: Error, errorInfo: React.ErrorInfo)")]),t._v(" "),s("ul",[s("li",[t._v("任何子组件在渲染期间，生命周期方法中或者构造函数 "),s("code",[t._v("constructor")]),t._v(" 发生错误时调用")]),t._v(" "),s("li",[t._v("错误边界不会捕获下面的错误\n"),s("ul",[s("li",[t._v("事件处理 (Event handlers) （因为事件处理不发生在 React 渲染时，报错不影响渲染)")]),t._v(" "),s("li",[t._v("异步代码 (Asynchronous code) (例如：setTimeout or requestAnimationFrame callbacks)")]),t._v(" "),s("li",[t._v("服务端渲染 (Server side rendering)")]),t._v(" "),s("li",[t._v("错误边界本身(而不是子组件)抛出的错误")])])])])])]),t._v(" "),s("h3",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"https://juejin.im/post/5df648836fb9a016526eba01",target:"_blank",rel:"noopener noreferrer"}},[t._v("你真的了解 React 生命周期吗"),s("OutboundLink")],1),s("br"),t._v(" "),s("a",{attrs:{href:"https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#preferred-solutions",target:"_blank",rel:"noopener noreferrer"}},[t._v("你可能不需要使用派生 state"),s("OutboundLink")],1)])]),t._v(" "),s("ul",[s("li",[t._v("发起 ajax 请求，获取数据 "),s("code",[t._v("componentDidMount")])]),t._v(" "),s("li",[t._v("使用 refs 获取真实 DOM "),s("code",[t._v("componentDidMount")])]),t._v(" "),s("li",[t._v("将 "),s("code",[t._v("props")]),t._v(" 变成 内部 "),s("code",[t._v("state")]),t._v(": "),s("code",[t._v("static getDerivedStateFromProps")])]),t._v(" "),s("li",[t._v("控制组件是否更新 "),s("code",[t._v("shouldComponentUpdate")]),t._v(" "),s("code",[t._v("return true | false")])]),t._v(" "),s("li",[t._v("当外部的 props 改变时，如何再次执行请求数据、更改状态等操作\n"),s("ul",[s("li",[s("p",[t._v("使用 "),s("s",[s("code",[t._v("componentWillReceiveProps")])])])]),t._v(" "),s("li",[s("p",[t._v("使用 "),s("code",[t._v("static getDerivedStateFromProps")]),t._v(" + "),s("code",[t._v("componentDidUpdate")]),t._v(" 加载数据")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ExampleComponent")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("React"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Component")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("externalData")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDerivedStateFromProps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("nextProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prevState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" prevState"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prevId"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("externalData")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("prevId")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" nextProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentDidMount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_loadAsyncData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 借助 componentDidUpdate")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentDidUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("prevProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prevState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("externalData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_loadAsyncData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentWillUnmount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_asyncRequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_asyncRequest"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("cancel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("externalData "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Render loading state ...")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Render real UI ...")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("_loadAsyncData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_asyncRequest "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("asyncLoadData")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("externalData")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_asyncRequest "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("externalData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br")])])]),t._v(" "),s("li",[s("p",[t._v("使用 "),s("code",[t._v("static getDerivedStateFromProps")]),t._v(" 更改状态")])]),t._v(" "),s("li",[s("p",[t._v("只用 "),s("code",[t._v("componentDidUpdate")]),t._v(" 的写法")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("componentDidUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"componentDidUpdate"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("age")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("props"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("age "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])])])])])])])}),[],!1,null,null,null);s.default=n.exports}}]);